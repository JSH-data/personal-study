##### 도커 허브란?
- 도커가 공식적으로 제공하고 있는 이미지 저장소 누구나 이미지를 업로드하고 다운로드 받을 수 있습니다. 

##### 이미지를 검색하는 방법
- 이미지를 원하는 레포지토리에서 받으려면 접두어를 붙여야합니다.

```
docker search ubuntu
docker search docker.io/ubuntu // 도커 허브의 이미지만 검색합니다. 
```

##### 도커 이미지를 직접 만드는 방법
1. **컨테이너 생성**
```
docker run -i -t --name commit_test ubuntu:14.04
```
2. **컨테이너에 변경사항 추가**
```
echo test_first! >> first
```
3. **컨테이너 커밋**
	- 컨테이너에서 빠져나와 `commit` 명령어를 통해 컨테이너를 이미지로 만듭니다. 
	- 태그를 지정하지 않는 경우 latest로 자동 인식됩니다. 
```
docker commit [options] container [repo[:tag]]

// -a: author
// -m: message
docker commit -a "alicek106" -m "first commit" commit_test commit_test:first
```

##### 도커 이미지의 구조
- 도커 이미지는 컨테이너 변경 사항이 레이어로 쌓여 업데이트 됩니다. 

##### 도커 이미지의 삭제
- `docker rmi` 명령어를 통해 이미지를 삭제할 수 있습니다. 
- 만약 삭제하려는 이미지를 사용 중인 컨테이너가 존재한다면 삭제가 불가능합니다. (단, `-f` 옵션을 활용하여 강제 삭제가 가능합니다.)
	- 강제 삭제를 진행한 경우 이미지의 이름이 none 처리되고 **dangling** 이미지로 바뀌게 됩니다.
```
// 댕글링 이미지를 확인하는 방법
docker images -f dangling=true
```
- 이미지를 삭제하였지만 해당 이미지를 사용 중인 하위 이미지가 있다면 이미지 레이어 파일은 삭제되지 않고 남게 됩니다. 

##### 이미지 추출
- 도커 이미지를 별도로 저장하거나 옮기는 경우 이미지를 단일 바이너리 파일로 저장시킬 수 있습니다. 
```
// -o: 추출할 파일 명
docker save -o ubuntu_14_04.tar ubuntu:14.04
```
- 추출된 이미지를 도커 엔진에 로드하는 방법은 다음과 같습니다 
```
docker load -i ubuntu_14_04.tar
```
- `commit` 명령어를 통해 이미지를 만드는 경우 -d와 같은 커멘드 옵션도 함께 저장이 됩니다. 만약 커멘드 옵션을 제외하고 이미지를 추출하고 싶다면 `export` 명령어를 사용해야합니다. 
- 이미지를 아래처럼 단일 파일로 추출 시 이미지 용량을 각각 따로 차지하므로 권장되는 방식은 아닙니다. 
```
docker export -o rootFS.tar mycontainer

// myimage:0.0 이라는 이름을 가진 이미지 저장 단, 히스토리가 없어지기 때문에 유의해야합니다.
docker import rootFS.tar myimage:0.0
```
##### 이미지 배포
- 도커 이미지를 단일 파일로 추출하면 용량이 크기 때문에 배포가 현실적으로 어렵습니다. 
- 이때 공개되어도 괜찮은 이미지는 도커 허브에 올리고 중요한 이미지라면 개인 저장소를 사용할 수 있습니다. 

##### 저장소에 이미지 올리기
1. 새로운 이미지 생성
```
docker run -i -t --name commit_container1 ubuntu:14.04

docker commit commit_container1 my-test-repository:0.0
```
2. 태그 지정
	- 레포지토리를 특정하기 위해 태그로 접두사를 추가합니다.
```
docker tag my-test-repository:0.0 seunghwa64/my-test-repository:0.0
```
3. 이미지 저장소에 올리기
```
docker push seunghwa64/my-test-repository:0.0docker push seunghwa64/my-test-repository:0.0
```