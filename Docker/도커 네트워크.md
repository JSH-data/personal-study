### 도커가 컨테이너 내부 IP를 할당하는 방법

- 도커는 컨테이너 내부에 내부 IP를 순차적으로 할당합니다. 따라서 컨테이너를 재시작하는 경우 매번 달라질 위험이 있습니다. 
- IP 할당 과정은 컨테이너 시작 시 `veth`라는 네트 워크 인터페이스를 생성하여 이뤄집니다. (외부와 연결되기 위해 생성되는 것입니다.)

### ifconfig를 통해 네트워크 인터페이스 확인하기
- docker는 `veth` 네트워크 인터페이스를 생성합니다. 
- `docker0` 브리지는 각 컨테이너의 `veth`를 호스트의 `eth0`과 연결합니다. 
![[Pasted image 20231203193800.png]]
### 도커에서 자체적으로 제공하는 네트워크 드라이버

- 도커에서 자체적으로 제공하는 네트워크 드라이버 종류는 다음과 같습니다.
	- **네트워크 드라이버**는 컴퓨터의 네트워크 어댑터(네트워크 카드 또는 무선 랜 카드 등)와 운영 체제(OS) 사이에서 통신할 수 있도록 도와주는 소프트웨어입니다. 네트워크 카드의 하드웨어를 제어하고, 데이터 전송을 관리하며, 네트워크에 연결되어 있는 다른 장치 또는 컴퓨터와의 통신을 용이하게 해줍니다.
![[Screenshot 2023-12-03 at 7.44.59 PM.png]]
- 브리지 네트워크는 docker0 브리지를 활용하도록 설정되어 있습니다. 
	- 이 네트워크는 172.17.0. IP 대역을 컨테이너에 순차적으로 할당합니다. 
	- ![[Screenshot 2023-12-03 at 7.50.46 PM.png]]

### 도커의 브리지 네트워크
- docker0 이 아닌 사용자 정의 브리지를 통해 외부와 통신이 가능하게 할 수 있습니다. 
```
// 새로운 브리지 네트워크를 생성하는 방법
docker network create --driver bridge mybridge

// 네트워크 브리지를 선택하여 컨테이너를 생성하는 방법
docker run -i -t --name mynetwork_container --net mybridge ubuntu14.04

// 네트워크 브리지 연결 해제
docker network disconnect mybridge mynetwork_container
```

### 호스트 네트워크
- 네트워크를 호스트로 설정하면 호스트의 네트워크 환경을 그대로 사용할 수 있습니다. 
```
docker run -i -t --name network_host \
--net host \ 
ubuntu:14.04
```
- 호스트 모드를 사용하는 경우 별도의 포트 포워딩없이 바로 서비스를 시작할 수 있습니다. 

### 논 네트워크
- none은 아무런 네트워크를 사용하지 않는 것을 의미합니다. 
```
docker run -i -t --net none
```

### 컨테이너 네트워크 
- 다른 컨테이너를 --net 옵션으로 주는 경우 컨테이너의 네트워크 네임스페이스 환경을 공유할 수 있습니다. 
- 공유되는 속성은 내부 IP, MAC 주소 등입니다. 

```
docker run -i -t -d --net container:[다른 컨테이너의 이름] [이미지 이름]
```

### 브리지 네트워크와 --net-alias
- 브리지 타입의 네트워크와 run 명령어의 --net-alias 옵션으로 특정 호스트 이름 컨테이너 여러 개에 접근할 수 있습니다. 
```
docker run -i -t -d --name network_alias_container1 --net mybridge --net-alias alicek106 ubuntu:14.04
```
- 여러개의 컨테이너에 동일한 alias를 설정한 경우 Docker 내부 DNS는 매번 IP 리스트를 새롭게 반환합니다. (라운드로빈 알고리즘입니다. )
- 해당 alias로 ping을 보내게되면 해당 리스트에서 첫번째 값에 ping 요청을 보내게 됩니다. 

### MacVLAN 네트워크
- MacVLAN은 호스트의 네트워크 인터페이스 카드를 가상화해 물리 네트워크 환경을 컨테이너에게 동일하게 제공합니다. 